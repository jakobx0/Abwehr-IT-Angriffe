>[!info] Def. IT-Forensik
<mark style="background: #ABF7F7A6;"><mark style="background: #ABF7F7A6;"></mark></mark>IT-Forensik ist die streng methodisch vorgenommene Datenanalyse auf Datenträgern und in Computernetzen zur Aufklärung von Vorfällen unter Einbeziehung der Möglichkeiten der strategischen Vorbereitung insbesondere aus Sicht eines Anlagenbetreibers eines IT-Systems
>>[!tip] Netzwerk-Forensik:
Netzwerkforensik als Teildisziplin der IT-Forensik beschäftigt sich mit Erfassung, Speicherung, Analyse und Auswertung von Artefakten die in Zusammenhang mit Vorgängen in Netzwerken stehen.

### **Fünf Grundprinzipien für den Umgang mit elektronischen Beweismitteln**
>[!example]
==1.Datenintegrität==: Unabhängig davon, ob die Datenspur nun lokal oder remote vorliegt: In beiden Fällen müssen die gefundenen potentiellen Beweise fachgerecht gesichert werden. 
==2.Beweismittelkette==: Die Chain of Custody (CoC) meint die chronologische Dokumentation von Beweisen. Das umfasst üblicherweise die Aufzeichnung aller Tätigkeiten, die bei der Untersuchung der elektronischen Spuren und Asservate durchgeführt wurden.
==3.Fachliche Unterstützung:== Wenn davon auszugehen ist, dass wir digitale Spuren und Belege im Rahmen einer Untersuchung sicherstellen müssen, sollten die verantwortlichen Personen keine Zeit verlieren, sondern sich gleich an einen Spezialisten, oft auch einen externen Berater, wenden. ==4.Angemessene Schulung:== Sollten keine Experten vor Ort sein, so müssen die mit der Spurensicherung und Erstanalyse betrauten Personen entsprechend geschult sein. 
==5.Rechtskonformität:== Der für den Fall Verantwortliche muss die allgemeinen forensischen und prozessualen Grundsätze befolgen sowie die geltenden gesetzlichen Normen und Bestimmungen einhalten. Dies betrifft insbesondere den Besitz sowie den Zugang zu elektronischen Beweismitteln, der klar geregelt sein muss.

### Methodik zur Durchführung einer Netzwerkforensischen Untersuchung
![[Pasted image 20241031201017.png]]
> [!info] OSCAR
> - **O – Obtain Information (Informationen sammeln)**: Hier werden relevante Informationen über den Vorfall gesammelt. Dazu gehören Protokolldateien, Netzwerktopologie, Netzwerkverkehr, Zeugenberichte oder Systemkonfigurationen. Ziel ist es, eine umfassende Datengrundlage für die Analyse zu schaffen. Gibt es ein Kommunikationssystem für Vorfälle und wie und wo werden Beweise abgelegt?
> >
> - **S – Strategize (Strategie entwickeln)**: Auf Basis der gesammelten Informationen wird eine Strategie entwickelt, um die Untersuchung effizient durchzuführen. Hierbei wird festgelegt, welche Tools und Methoden genutzt werden, um Beweise zu sichern und potenzielle Angriffspunkte zu identifizieren.
> 	- Beispiel Priorisierung von Bewisquellen:
> 
> 	![[Pasted image 20250929151120.png]]
> 	
>> [!tip] Untersuchungsstrategie:
> >1. Verstehen der Ziele und Zeitrahmen der Untersuchung
> >2. Ressourcen auflisten Personal, Zeit und Ausrüstung
> >3. Identifizieren von Beweisquellen
> >4. Wertschätzen für jede Beweisquelle
> >5. Priorisieren der Beweissicherung
> >6. Planen sie der erste Erfassung / Analyse
> >7. regelmäßige Kommunikation -> Updates
> >8. nach erster Analyse auch weitere Analysen möglich
>
> - **C – Collect Evidence (Beweise sammeln)**: Zusammentragen von Beweisen aus jeder Quelle:
> 	1.  **Dokumentation:** Anfertigen eines Protokolls alle durchgeführten Aktionen und untersuchten Systeme mit folgenden Inhalten: **Zeit**, **Quelle** für **gefundenen Spuren**, **Erfassungmethode** und **beteiligte Ermittler**.
> 	2. **Beweisaufnahme:** Erfassen von **Paketen**, das Kopieren von **Log Dateien**, die Erstellung von **Laufwerksabbildern**
> 	3. **Übertragung und Transport:** Aufrechterhaltung der Chain of Custody, d.h Beschlagnahme, die Kontrolle, Weitergabe, Analyse und Disposition von Beweisen, physisch oder elektronisch. Da Zulässigkeit  von Beweismitteln von der Relevanz und Zuverlässigkeit abhängt, sollen Ermittler Quelle, Erfassungsmethode und Beweisaufnahmeweg dokumentieren 
> 
> >
> - **A – Analyze (Analysieren)**: Die gesammelten Beweise werden detailliert analysiert, um den Vorfall nachzuvollziehen und mögliche Täter zu identifizieren. Dieser Schritt umfasst die Rekonstruktion des Vorfalls sowie die Identifikation der Schwachstellen, die den Angriff ermöglichten.
> >
> - **R – Report (Bericht erstellen)**: Abschließend wird ein Bericht erstellt, der alle Erkenntnisse zusammenfasst. Der Bericht dient als Dokumentation für rechtliche Schritte und als Grundlage für zukünftige Sicherheitsmaßnahmen zur Prävention.

### Dateiformate und Beweismittelquellen
> [!info] Arten von netzbasierten Spuren
>
>Es gibt verschiedene Arten von netzbasierten Spuren und Beweismitteln die, bezogen auf Ihren forensischen Wert und ihrer Analyse, spezifosche Vor- und Nachteile aufweisen: 
>
![[Pasted image 20241031202855.png]]
>
>- **PCAP (Full Content Data)**: PCAP-Dateien enthalten vollständige Kopien des Netzwerkverkehrs, inklusive aller Datenpakete, die zwischen Geräten ausgetauscht wurden (Waw Data). Sie ermöglichen eine detaillierte Analyse von Netzwerkvorfällen, da jedes Paket bis auf die Inhalte analysiert werden kann. PCAP-Daten sind besonders hilfreich für die genaue Rekonstruktion eines Vorfalls.
>
>![[Pasted image 20251001180402.png]]
>
>	- Weiter Aufzeichnungsformate:
>		- lipcap
>		- PcapNg: Nachfolger von lipcap
>
>- **Warn- und Alarmmeldungen**: Immer wenn beim Auswerten des Netzwerkverkehres ein vordefiniertes Ereignis eintritt, wird dies möglicherweise eine Warnung auslösen. Wird bsp. eine bestimmte Signatur innerhalb eines Datenpaketes erkannt. Solche Alarmmeldungen werden regelmäßig durch sogenannte Network Intrusion Detection Systeme (NIDS) wie Suricata1 oder Snort2 erzeugt. 
>	- z.B über SNORT Message.
>
>		![[Pasted image 20251001182018.png]]
>
>>
>- **Sitzungsbezogene Daten**: Sitzungsdaten dokumentieren die Kommunikation zwischen zwei Systemen, ohne jedoch alle Paketdetails wie bei PCAP-Dateien zu speichern. Eine Netzwerksitzung fasst normalerweise den aggregierten Datenverkehr bzw. die Metadaten einer Konversation zwischen zwei Endgeräten im Netzwerk zusammen. Diese werden gruppiert und als **Flows** respektive **Netfolws** also Nachrichtenfolgen aufeinander bezogener Netzwerkpakete dargestellt.
>
>![[Pasted image 20251001181151.png]]
>
>>
>- **Statische Daten**: Liefern Informationen über Anzahl der aufgezeichneten, Start und Endzeiten von Verbindungen, Anzahl und Typ der verwendeten Dienste und Protokolle, die aktiven Netzwerkstationen, die am wenigsten aktiven Netzwerkknoten, Ausreißer bei der Netzwerknutzung, die durchschnittliche Paketgröße und Rate usw.
>>
>- **Log-Daten:** Sind mittgeschnittener Trafik Daten vorzuziehen. Einträge in Logdateien stellen fasst immer auf ein konkretes Ereignis ab, dass wir aus einer Aufzeichnung des Datenverkehrs mühevoll rekonstruieren müssen. 

>[!info] Unterschied ob eine Forensische Untersuchung oder ein Sicherheits Vorfall nachgegangen wird
>
![[Pasted image 20241031211403.png]]
>
>Betrachten wir dazu die Netzwerkkommunkation an sich.
>- Netzwerkkommunikation ereignet sich wenn ein Teil des Systems zum Sender wird und eine Information, codiert in das so genannte **Signal** durch einen Kanal übertragen wird um am Ende decodiert mit einem zweiten Teil des Systems, dem Empfänger, in Kontakt tritt. Diese Terminologie findet sich in dem erstmals von Claude Shannon und Warren Weaver in den späten 40er-Jahren des 20. Jahrhunderts eingeführten Shannon-Kommunikationsmodell.
>
>	![[Pasted image 20251001222454.png]]
>
>Nachfogend einige Elemnte einer End-to-End-Forensik Untersuchung (EC-Coucil Press, 2010)
>
>- **Das Ende-zu-Ende-Konzept:** Eine Untersuchung erfasst alle Elemente eines Angriffs, einschließlich der Vorgehensweise, d.h. wie der Angriff begann, welche Zwischengeräte während  des Angriffs eingesetzt wurden und wer angegriffen wurde.
>>
>- **Beweismittelsuche:** Sobald ein Ermittler weiß, welche Geräte von einem Angriff betroffen sind, wir er auf diesen Geräten nach Spuren und Beweisen suchen. Der Ermittler kann diese Spuren dann analysieren, um mehr über den Angriff und den Angreifer zu erfahren.
>>
>- **Fallstricke bei der Erfassung von Netzwerknachweisen:** Bei der Protokollanalyse kann die Spur oder das Indiz innerhalb weniger Sekunden verloren gehen, da Protokolle sich schnell ändern und Informationen überschrieben werden. Manchmal ist eine Genehmigung erforderlich, um Beweise aus bestimmten Quellen zu erhalten. Dieser Vorgang wird in der Regel Zeit in Anspruch nehmen, wodurch die Wahrscheinlichkeit eines Beweisverlustes deutlich ansteigt.
>>
>- **Weitere mögliche Hindernisse bzw. Herausforderungen in diesem Zusammenhang:**
>	- Nachgehen einer falschen Spur durch Verwechslung normaler Computer- oder Netzwerkaktivität mit einem Angriff
>	- Lücken in der Beweiskette ergeben nur Vermutungen
>	- Protokolle sind mehrdeutig, unvollständig oder fehlen
>	- Spuren führen auf einen im Ausland befindlichen Server, damit
>	- rechtliche wie auch politische Fragestellungen
>>
>- **Ereignisanalyse:** Nachdem ein Ermittler alle Informationen geprüft hat, korreliert er seine Ermittlungsergebnisse aus den verschiedenen Quellen um ein Gesamtbild zu erhalten.
>>
>- **Grundlegend:** Auch wenn eine Untersuchung eines Sicherheitsvorfalles im Unternehmen nicht zwangsläufig zu einer rechtlichen Folge führt, empfiehlt es sich frühzeitig forensische Untersuchungsmethoden zu bemühen. Dies vor allem da rechtliche Schritte im Nachhinein jederzeit möglich sind und sich als Folge der Untersuchung ergeben können.
>>
><div style="page-break-before: always; break-before: page;"></div>
>### Ausgangspunkt für forensische Untersuchung
>Jede forensische Untersuchung muss irgendwo beginnen, sei es in Form eines Berichts oder wegen einer im Raum stehenden Anzeige durch einen Mitarbeiter sein. Ebenso kann eine automatisch erzeugte Warnmeldung eines Computersystems Anlass für eine Untersuchung darstellen. Das nennt man auch Anlassbezogene Untersuchung. In der Praxis kann dies etwa auch in Form eines Alarms von einem IDS, auffälligen Protokolleinträgen und abnormalem Systemverhalten (wie hohe CPU-Auslastung), eine Beschwerde-E-Mail oder eine Kombination aus verschiedenen Indikatoren sein. Wenn also ein sicherheitsrelevanter Vorfall in irgendeiner Weise bekannt wird, so ist es immer notwendig, zunächst die Art der Quelle zu berücksichtigen.
>>
>### Forensische Untersuchung von Sicherheitsvorfällen
>
>**Stichwort: Zuverlässigkeit der Informationen** 
>Eine Person, die eine Beschwerde wegen Belästigung wegen wiederholter verbaler Angriffe, die in Form von Nachrichten auf dem Bildschirm erscheinen, als Beleg angibt, können möglicherweise auf einen Computerwurm / -virus zurückzuführen sein. Der Alarm des Intrusion Detection Systems wiederum kann nur auf einen versuchten oder aber erfolglosen Einbruch hinweisen. Vielleicht handelt es sicher aber lediglich um falschen Alarm. Daher muss immer genau abgewogen werden, wie valide die Informationen sind. Das gilt gleichermaßen für menschliche Zeugenaussagen wie auch für elektronische Spuren
