>[!info] Beweisaufnahme
>Abhängig von den verfügbaren technischen Mitteln sowie den gesetzlichen und behördlichen Anforderungen wird nicht in jedem Fall möglich sein, eine vollständige Sicherung und Analyse bzw. ein vollständiges Protokoll aller übertragenen Daten zu erfassen. Mitunter ist es auch schlichtweg technisch nicht möglich bzw. nur mit unverhältnismäßig hohem Aufwand realisierbar den Datenverkehr im Netzwerk vollständig mitzuschneiden. Befassen wir uns daher im folgenden der Problematik der Aufzeichnung von Datenverkehr in Netzwerken.

>[!abstract] Unterscheidung der Vorgehen:
Ganz allgemein unterscheidet man beim Abhören des Datenverkehrs nach zwei Gesichtspunkten:
>
**Passives Vorgehen:**
Mitschneiden erfolgt ohne dass andere Teilnehmer im Netzwerk dies erkennen.
In einem kabelgebundenen LAN die mit Hubs ausgestattet sind, muss
Netzwerkkarte in den <mark style="background: #FF5582A6;">promiskutiven</mark> Modus geschalten werden und schon kann es los gehen.
Auch im Drathlosen Netzwerk z.B -> Mitschneiden des Datenverkehrs (Sniffing), da es sich um ein Shared Media handelt.
>
**Aktives Vorgehen:**
Im segmentieren Netzwerk wird aktives Eingreifen gefordert.
Angreifer muss Segmentierung umgehen um Datenpakete an sich weiterzuleiten.
Für forensische Untersuchung ist es meist nur Möglich spuren zu sammeln wenn der Ermittler auf bestimmte Netzwerkgeräte zugreifen kann.
>
>Beispielsweise kann es erforderlich sein, ein Systemprotokoll von einem Server aus der Ferne abzurufen oder es muss ein Netzwerkscan durchgeführt werden, um den aktuellen Netzwerkstatus zu ermitteln.
>
**Passives oder aktives Vorgehen:**
Bei einer Untersuchung sollten Ermittler bemüht sein den Netzwerkverkehr nur Passiv aufzuzeichnen (Augenblickliche Aufzeichnungen) um nichts zu verändern.
>
>Am Besten gelingt dies, wenn man die Aufzeichnung in dem Augenblick durchführt, in dem die Datagramme übertragen werden, egal ob über Kabel oder durch die Luft in einem Funk- bzw. Drahtlosnetzwerk. An dieser Stelle noch ein wichtiger Hinweis: Wenn die Ermittler Datenverkehr aufzeichnen können, können dies umgekehrt auch die Angreifer!

>[!info] ISO-OSI Referenzmodell
>
>![[Pasted image 20251012155325.png]]
>
>#### **Layer 0 - OSI-Schicht "0" Medium**
>
>Eine Schicht 0 gibt es streng genommen gar nicht. Man kann aber sinnvollerweise das Medium über das die Kommunikation stattfindet als Schicht 0 bezeichnen. Hier einige Beispiele für Medien:
>- Luft -> Drahtlose Übertragung
>- Kabel -> Drahtgebundene Übertragung
>Als Schicht 0 kann man also die eigentliche Übertragungsstrecke verstehen. Schutzbedarf gemäß IT Grundschutz besteht hier also für die Übertragungstrecke an sich. 
>
>Checkliste für Sicherheitsrichtlinien:
>- [ ] Vorhandensein bzw. Fehlen von räumlichen Zugangsbeschränkungen für Server, Netzwerkhardware bzw. kabel
>- [ ] Überschreiten von räumlichen Zugangsbeschränkungen
>- [ ] Umgang mit ausgesonderter Rechentechnik
>- [ ] Dumpster Diving
> 
> #### **Layer-1 Physical (Bitübertragungsschicht)**
>
>**Datenerfassung in kabelgebundenen Netzwerken**
>
>Die Netzwerkkarte (im Folgenden als Network Interface Card (NIC) bezeichnet) stellt die physische Verbindung zwischen Rechner und Netzwerk her. In Abhängigkeit der gewählten Vernetzungstechnik existieren unterschiedliche NICs mit geeigneten Schnittstellen für das Medium. Die Bitübertragungsschicht nimmt normalerweise alle notwendigen Anpassungen für das genutzte Medium vor, so dass die Daten korrekt übertragen werden können.
>
>Zum Abhören von Netzwerkverbindungen bzw. zur Überwachung des Datenverkehrs muss man in der Regel Zugriff auf das Medium haben.
>Das Sniffing von Daten auf einem Medium unterscheidet sich naturgemäß und variiert im Aufwand bzw. hat unterschiedliche Nebenwirkungen.
>![[Pasted image 20251012164021.png]]
>
>>[!example] Abhöhrtechniken
>>**Koaxialkabel**
>>Es können sogenannte Vampire verwendet werden -> zapfen das Kabel an um Daten zu saugen. Gerät wird auf Kabelgeklemmt und die Ummantelung durch gebissen. keine 2 Ausleitungen nötig für Mittschnitt.
>>
>>**Twisted-Pair**
>>Inline Network taps werden zwischen physikalisch gekoppelten Geräten eingefügt. Sie haben 4 Ausgänge(Ports) zwei verbundene Inline Verbindungen, um die Weiterleitung des normalen Datenverkehrs zu erlauben und zwei Sniffing Ports, die diese Daten Spiegeln. Bei bidirektionalen Verbindungen nicht möglich. Tap braucht keine Stromversorgung um Pakete **passiv** weiterzuleiten.
>>
>>Im Gigabit-Ethernet kein vollständiges Abhören möglich -> Datenkabel bidirektional. -> 2 Ausleitungen nötig für Mittschnitt.
>>
>>**Lichtwellenleiter**
>>Arbeiten ähnlich wie Inline-Taps für Kupferkabel. Die Ermittler spleißen das optische Kabel und schließen es an jeden Anschluss eines Abzweigs an oder führen einen vorgefertigten Abzweig an einer Stelle ein, an der das optische Kabel endet, z. B. vor einem Switch oder Patch Panel. -> 2 Ausleitungen nötig für Mittschnitt.
>>
>>**Network Taps**
>>Dienen zur physischen Überwachung des Datenverkehrs für alle drei oberen sind entsprechende Abhöreinrichtungen (Network Taps) verfügbar welche ein Mitlesen erlauben.
>>
>>In jedem Fall ist hierfür der physische Zugang (Layer 0). zu den kabeln notwendig.
>>
>#### **Layer-2 DataLink (Sicherungsschicht)**
>
Aufteilung in MAC(Media Access Control) und LLC(Logical link Control) - Schicht.
>![[Pasted image 20251012202701.png]]
>
>MAC-Schicht:
>- Datenvorbereitung für Übertagung
>- Fehler/Adresserkenunng
>- Zugriff auf Übertragungsmedium regeln
>- Protokolle zur Kollisionserkennung Carrier Sense Multiple Access (CSMA) 
>
>LLC-Schicht:
>-  Schnittstelle zu höheren Ebenen (Network Layer)
>- Ablaufsteuerung
>- Basiert auf Klassischen DataLink Protokollen
>
![[Pasted image 20250201133930.png]]
>
>### Aufbau Ethernet Frame:
 >- Ziel MAC-Adresse
 >- Quell MAC-Adresse
 >- Typ (Protokoll Informationen oder Länge Payload)
 >- Daten (Payload)
 >- Checksumme (Frame Check Sequence)
 >
![[Pasted image 20250201134126.png]]
>
>Über das 2 Byte große Feld im Ethernet-Frame (Ethertyp) wird das verwendete Protokoll der 3. OSI Schicht bestimmt oder es definiert die Größe des Payload (Nutzdaten) des Ethernet Frame. 
>
>Ethertypen:
>- 0x0800 IPv4
>- 0x86DD IPv6
>- 0x0806 ARP
>
>#### MAC-Adresse - Funktion und Aufbau
>Größe (6 Byte)
>- 3 Byte Organisational Unique Identifier OUI
>- 3 Byte Vendor Information/NIC Hardware Serial
>
>**OUI + Vendor Information:** Hinweise auf Hersteller, den Treiber und die Firmware und etwaige Sicherheits-Lücken
> 
 
>[!abstract] Datenerfassung in kabelgebundenen Netzwerken
>
>Kopplungseinheiten:
>- Weiterleitung Datenverkehr
![[Pasted image 20250111151111.png]]
>
**Netzwerk-Hub**
An alle Stationen Physisch verbunden. Wenn er ein Frame erhält leitet er ihn an alle Ports weiter. -> jedes am Hub angeschlossene Gerät empfängt gesamt Verkehr. Somit kann der gesamte Verkehr auf dem Netzsegment erfasst und überwacht werden.
>
**Repeater**
Empfängt Optische  oder elektrische Signale und sendet diese an alle angeschlossenen Netzwerksegmente.
>
**Router**
Aufgabe ist die Wegwahl für Pakete die über das Netzwerk versendet werden
>
**Bridge**
Zur Verbindung von Netzwerksegmenten. Empfängt Pakete von einem Netzwerksegment prüft diese und leitet diese an mehrere oder ein Netzwerksegment weiter.
>
**Switches**
Wie Hubs, bloß dass empfangenes Paket nur an Port der Zielstation weiter geleitet wird.
>- Er weis von wo, wohin, wegen -> MAC-Adresse Sind mit Firmware ausgestattet die es ihnen ermöglicht, herauszufinden, welche Stationen mit welchen Ports in seinem CAM Tabelle verbunden sind. kann so konfiguriert werden werden dass, der Verkehr von einem oder mehreren Ports zu einem anderen Port replieziert wird (Port Miroring)
