>[!question] Zielstellung:
> In diesem Praktikum erweitern Sie Ihr Verständnis zur Schlüsselverwaltung im Arbeits- speicher anhand von Krypto-Containern. Zu diesem Zweck wird exemplarisch der RAM einer Windows- VM gesichert und der Master-Key eines TrueCrypt- bzw. eines VeraCrypt-Containers ausgelesen.
#### Grundlagen
>[!abstract]
> Bei der Verwendung von verschlüsselten Containern oder Laufwerken in einem System erfolgt die Ver- und Entschlüsselung in der Regel über ein vom Nutzer gewähltes Passwort. Dieses Passwortdient jedoch nicht direkt als Eingabewert für die kryptografischen Algorithmen, sondern schützt einen speziell generierten, deutlich komplexeren Hauptschlüssel (Master-Key). Das Nutzerpasswort fungiert  somit als Schutzmechanismus für diesen Master-Key. Sobald der Zugriff auf das verschlüsselte Medium angefordert wird, fordert das System einmalig1 das Passwort an, um den Master-Key zu entschlüsseln. Der entschlüsselte Schlüssel verbleibt anschließend im Hauptspeicher, damit kryptografische Operationen auf dem Medium ohne wiederholte Passwort-
abfragen ausgeführt werden können.
TrueCrypt ist eine quelloffene Software zur Erstellung und Verwaltung verschlüsselter Speicherme-
dien. Die kryptografischen Operationen werden transparent direkt beim Lesen und Schreiben von
Daten durchgeführt, was eine praktikable und weit verbreitete Methode darstellt, sensible Informatio-
nen sicher abzulegen. Die Entwicklung von TrueCrypt wurde 2014 bzw. 2016 eingestellt und in Form
des Forks VeraCrypt weitergeführt. Die Grundarchitektur beider Projekte ist vielfach vergleichbar –
VeraCrypt ergänzt diese jedoch um erhöhte Sicherheitsparameter, zusätzliche Algorithmen und zahl-
reiche Fehlerbehebungen. Da beide Projekte Open Source sind, lassen sich interne Datenstrukturen
und Implementierungsdetails aus dem Quellcode entnehmen und für die forensische Analyse nutzen.
Eine häufig genutzte Funktion der genannten Tools ist die Verwendung verschlüsselter Container,
in denen vollständige Dateisysteme eingebettet sind. Neben regulären Containern besteht die Mög-
lichkeit, sogenannte versteckte Container anzulegen, die mit einem separaten Passwort geöffnet
werden und alternative Daten enthalten. Dieses Konzept dient der glaubhaften Abstreitbarkeit (engl.
plausible deniability): Unter äußerem Druck können vorbereitete, unkritische Daten offengelegt wer-
den, während die eigentlichen sensiblen Informationen verborgen bleiben.
Bei der Entsperrung eines Containers wird das eingegebene Passwort sequentiell auf beide potenzi-
ellen Speicherbereiche angewendet. Zur Überprüfung einer erfolgreichen Entschlüsselung prüft das
System auf die korrekte Darstellung einer vier Byte langen ASCII-Zeichenkette (TRUE für TrueCrypt bzw.
VERA für VeraCrypt). Für den Anwender äußert sich das Ergebnis ausschließlich darin, ob der Container
geöffnet werden kann oder nicht – es erfolgt keine erkennbare Rückmeldung darüber, ob es sich um
einen regulären oder einen versteckten Datensatz handelt.
Eine Container-Datei besitzt einen standardisierten Aufbau, der schematisch in Abbildung 1 dar-
gestellt ist. Sie beginnt stets mit dem Volume-Header des normalen Containers, gefolgt vom Volume-
Header des versteckten Containers (oder zufälligen Daten, sofern kein versteckter Container existiert)
sowie dem anschließenden Datenbereich. Am Ende der Datei befinden sich Sicherheitskopien beider
Volume-Header. Unabhängig davon, ob es sich um einen normalen oder einen versteckten Contai-
ner handelt, besteht jeder Volume-Header aus einem 64 Bytes großen, unverschlüsselten Salt-Wert,