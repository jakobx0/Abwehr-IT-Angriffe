>																					[!zielstellung]
>In diesem Praktikum vertiefen Sie Ihr Verständnis für die Angreifbarkeit von Übertragungsmedien in der digitalen Kommunikation am Beispiel drahtloser Netzwerke nach dem IEEE 802.11- Standard. Dabei geht es darum, ein Gefühl für die Besonderheiten von Funksignalen zu entwickeln und zu verstehen, warum diese Schicht der Kommunikation besonders exponiert ist.

>[!tip]- Grundlagen und Hintergründe
>Die Bitübertragungsschicht (Schicht 1 des OSI-Referenzmodells) sorgt für die physikalische Verbindung und damit für die Übertragung einzelner Bits zwischen Netzwerkteilnehmern. Im kabelgebundenen Ethernet geschieht dies klassisch über Koaxialkabel, verdrillte Kupferleitungen (Twisted Pair) oder Lichtwellenleiter (Glasfaser). Im kabellosen LAN (Wireless LAN, WLAN) übernehmen elektromagnetische Funkwellen diese Rolle als Übertragungsmedium.
>
>Der Begriff WLAN beschreibt allgemein alle kabellosen lokalen Netzwerke (Wireless Local Area Network). IEEE 802.11 hingegen ist ein konkreter Protokoll-Standard, der die technische Umsetzung eines WLANs definiert. Die Wi-Fi Alliance – ein Zusammenschluss von mehreren hundert Unternehmen – zertifiziert Geräte, die den IEEE 802.11-Standard einhalten, und vergibt dafür das bekannte Label „Wi-Fi Certified“. Die Bezeichnung Wi-Fi (auch WiFi oder Wifi) steht für Wireless Fidelity und kennzeichnet Geräte, die interoperabel nach IEEE 802.11 miteinander kommunizieren können.
>
>Der IEEE 802.11-Standard wurde seit seiner Veröffentlichung mehrfach erweitert, um neue Funktionen, höhere Datenraten und zusätzliche Frequenzbänder zu unterstützen. Eine Übersicht der wichtigsten Protokollvarianten zeigt Tabelle 1. Seit 2018 erhalten die Versionen neben ihren technischen Bezeichnungen (z. B. IEEE 802.11ac) auch einfachere Marketing-Namen wie „Wi-Fi 5“, die den Generationenwechsel für Endnutzer verständlicher machen.
>
>![[Pasted image 20251023190519.png]]
>
>Unabhängig von der eingesetzten Technologie und den jeweiligen Umweltfaktoren gilt grundsätzlich: Je höher die Frequenz, desto mehr Daten lassen sich übertragen – allerdings auf Kosten der Reichweite. Ein wesentlicher Faktor für die Übertragungsqualität ist die Interferenz, also die Störung durch andere Signalquellen. Das 2.4 GHz-Band ist besonders anfällig, da hier viele verschiedene Geräte funken und die überlappungsfreie Nutzung der Kanäle nur schwer möglich ist. Kommt es zu Überschneidungen, koordinieren Kollisionserkennungs- und Vermeidungsmechanismen (Collision Detection / Collision Avoidance) den Zugriff auf das Medium. Zusätzlich interagieren 2.4 GHz-Signale mit Flüssigkeiten. Dies führt zu Dämpfungseffekten, etwa durch den menschlichen Körper oder feuchte Wände. Das 5 GHz-Band leidet hingegen stärker unter Absorption durch feste Materialien: Wände werden schwerer durchdrungen, was die Reichweite einschränkt. Dafür treten hier weniger Störungen aus benachbarten Netzen auf – idealerweise mit Sichtlinie zwischen den Geräten.
>
>**Abbildung 1** zeigt die Kanalverteilung im 2.4 GHz-Band. Der erste nutzbare Kanal liegt bei 2412 MHz. Die Kanäle 12 und 13 sind in den USA nicht zugelassen, und Kanal 14 ist derzeit ausschließlich in Japan erlaubt. In frühen IEEE 802.11-Versionen wurde aus technischen Gründen mit größeren Kanalabständen gearbeitet, zusätzlich mit einem 2 MHz breiten Guard Band, was zu einer effektiven Kanalbreite von 22 MHz führte. In nachfolgenden Versionen hat sich eine Kanalbreite von 20 MHz als Standard etabliert.
>
>![[Pasted image 20251023191226.png]]
>
>Überlappen sich zwei Kanäle (z. B. Kanal 1 und 2), teilen sich die beteiligten Geräte denselben Frequenzbereich. Das führt zu Kollisionen bei der Übertragung, wodurch die effektive Datenrate sinkt. Im ursprünglichen IEEE 802.11- und 802.11b-Standard war eine Kanalbreite von 22 MHz vorgesehen. Damit lassen sich in den USA nur die Kanäle 1, 6 und 11 überlappungsfrei nutzen. In Japan kommt zusätzlich Kanal 14 hinzu. Außerhalb der USA steht ein größerer Frequenzbereich zur Verfügung. Dort hat sich die Konfiguration der Kanäle 1, 7 und 13 etabliert. Seit IEEE 802.11g (mit 20 MHz Kanalbreite) ist außerdem die Variante mit den Kanälen 1, 5, 9 und 13 möglich – allerdings nur, wenn keine Abwärtskompatibilität zu 802.11b-Geräten benötigt wird. Je nach Region lassen sich also drei bis vier Funknetze im 2.4 GHz-Band ohne Überlappung betreiben. Werden zusätzliche Netzwerke auf bereits belegten Standard-Kanälen eingerichtet, sinkt zwar die verfügbare Bandbreite für alle, die Qualität angrenzender Standard-Kanäle bleibt jedoch unbeeinträchtigt. In dicht besiedelten Gebieten zeigt sich in der Praxis jedoch oft ein anderes Bild: Viele Geräte nutzen veraltete Firmware, sind für den US-Markt vor konfiguriert oder beachten bei der automatischen Kanalwahl die länderspezifischen Vorgaben nicht. Die Folge ist eine Kanalbelegung, die häufig zu Interferenzen führt. Die Nutzung der Kanäle 2, 3, 4, 8, 10 und 12 sollte grundsätzlich vermieden werden, da sie in fast allen Fällen Störungen mehrerer Standard-Kanäle verursachen.
>
>Die Einführung von 5 GHz-Wi-Fi-Geräten hat viele der bekannten Probleme des 2.4 GHz-Bandes entschärft. Standardmäßig können hier nur überlappungsfreie Kanäle gewählt werden, sodass sich die Interferenz deutlich reduziert. Eine Übersicht der für den europäischen Raum verfügbaren Kanäle zeigt **Abbildung 2**. Neben den etablierten 20 MHz-Kanälen sind im 5 GHz-Band auch breitere Kanalbündelungen (40 MHz, 80 MHz, 160 MHz) möglich. Das Zentrum dieser Bündel liegt jeweils auf einem ungenutzten Primärkanal. Die höheren Kanalbreiten steigern theoretisch den Datendurchsatz, gehen jedoch mit geringerer Reichweite und erhöhter Störungsanfälligkeit einher.3 Dazu werden angrenzende, überlappungsfreie Kanäle gebündelt und gemeinsam genutzt.
>
>![[Pasted image 20251023192149.png]]
>
>Die Nutzung der 5 GHz-Kanäle unterliegt strengeren Regularien als im 2.4 GHz-Band. Grundsätzlich müssen alle Geräte eine Sendeleistungsregelung (Transmitter Power Control, TPC) implementieren. Damit wird die Ausgangsleistung begrenzt, um Störungen von Radar, Satelliten oder dem Flugverkehr zu vermeiden. Die Kanäle 36 – 64 sind ausschließlich für den Einsatz in Innenräumen freigegeben, während die Kanäle 100 – 140 auch im Außenbereich genutzt werden dürfen. Eine Besonderheit stellen die Kanäle 52 – 140 dar: Hier greifen Störungsvermeidungstechniken, da diese Frequenzen bereits vor der Einführung von Wi-Fi von anderen Funkdiensten belegt waren. Geräte müssen daher eine Dynamic Frequency Selection (DFS) unterstützen. DFS überwacht den Kanal kontinuierlich auf Radarsignale und wechselt automatisch, sobald ein bevorrechtigter Nutzer erkannt wird. In der Praxis bedeutet dies, dass bestimmte Kanäle temporär oder sogar dauerhaft gesperrt sein können – insbesondere in der Nähe von Flughäfen, Militäranlagen oder Wetterstationen. In Deutschland sind vor allem die Kanäle 120 – 128 durch Wetterradar (Terminal Doppler Weather Radar, TDWR) belegt und sollten in einem Umkreis von etwa 35 km um eine Station vermieden werden.
>
>Unabhängig von Frequenz oder Kanal erfolgt die Kommunikation im IEEE 802.11-Standard über sogenannte Frames. Ihr Aufbau ist bewusst generisch gehalten und besteht aus drei Bereichen: Metadaten (Header), den eigentlichen Nutzdaten aus höheren Protokollschichten (Payload) sowie einer Prüfsumme (Checksum). Falls unterstützt, ergänzt der Gerätetreiber einen Radiotap Header, der zusätzliche Empfangsinformationen wie Signalstärke, Kanal oder Antennennutzung enthält. Diese Angaben stammen vom Empfänger selbst und gehören nicht zum eigentlichen Frame – sind aber für Analyse und Forensik hochinteressant.
>
>IEEE 802.11 kennt drei grundlegende Frame-Typen mit unterschiedlichen Aufgaben: **Management Frames** steuern den Verbindungsauf- und -abbau und verwalten Netzwerkeigenschaften. **Control Frames** regeln den Zugriff auf das Medium und koordinieren die Übertragung. **Data Frames** schließlich transportieren die eigentlichen Nutzdaten. Der konkrete Aufbau eines Frames hängt dabei immer von seinem Typ und Subtyp ab.
>
>Kommunizieren mehrere Wi-Fi-Geräte miteinander, unterscheidet man zwei Kategorien: Endgeräte (Clients, Stations, Nodes) und Basisstationen (Access Points, AP oder Wireless Access Points, WAP). Der IEEE 802.11-Standard beschreibt verschiedene Topologien, über die diese Geräte eine funktionierende Kommunikation herstellen. Allgemein spricht man von Service Sets. Diese zeichnen sich durch gemeinsame Kommunikationsparameter (z. B. Frequenz, Modulation, Sicherheitseinstellungen), einen frei wählbaren Netzwerknamen, den Service Set Identifier (SSID), sowie eine eindeutige Adresse, den Basic Service Set Identifier (BSSID)aus. Im einfachsten Fall kommunizieren zwei oder mehr Endgeräte direkt miteinander, ohne Access Point. Dies wird als Independent Basic Service Set (IBSS) oder Ad-hoc-Netzwerk bezeichnet. Deutlich verbreiteter ist das Basic Service Set (BSS): Alle Geräte verbinden sich mit einem zentralen Access Point, der als organisatorischer und kommunikativer Mittelpunkt dient. Ist ein Access Point zusätzlich mit einem kabelgebundenen Netzwerk (Distribution System, DS) verbunden, können Frames zwischen Funk- und Kabelnetz übersetzt werden. Werden mehrere Access Points über ein DS gekoppelt, die gemeinsam ein einziges WLAN bereitstellen, spricht man von einem Extended Service Set (ESS). Verlässt ein Endgerät die Reichweite (Basic Service Area, BSA) eines Access Points, übernimmt automatisch der nächste – ein Prozess, der als Roaming bezeichnet wird und bei richtiger Konfiguration nahtlos funktioniert. Um Störungen zu minimieren, senden überlappende Basisstationen in einem ESS auf unterschiedlichen Kanälen. Ein schematisches Beispiel eines ESS zeigt **Abbildung 3**.
>
>![[Pasted image 20251023194208.png]]
>
 In einer Unternehmensumgebung werden Sie meist auf ein komplexes Extended Service Set (ESS) treffen, während ein typisches Heimnetzwerk in der Regel einem einfachen Basic Service Set (BSS) entspricht. Für die folgenden Betrachtungen können Sie sich auf ein kleines Infrastrukturnetzwerk in Form eines BSS konzentrieren, also ein oder mehrere Endgeräte, die mit einer Basisstation verbunden sind. Die grundlegenden Abläufe sind jedoch in allen Wi-Fi-Topologien sehr ähnlich und lassen sich entsprechend übertragen.
 >
 >Möchte ein Endgerät einem Netzwerk beitreten, durchläuft es mehrere Phasen. Zunächst erfolgt die Kontaktaufnahme zwischen Endgerät und Basisstation. Die Basisstation sendet in regelmäßigen Abständen sogenannte Beacon Frames, die die Verfügbarkeit des Netzwerks als Broadcast ankündigen. Ein Beacon Frame enthält Informationen zur SSID, unterstützte Bitraten und Hinweise zu Sicherheitsparametern. Empfängt ein Endgerät ein passendes Beacon Frame, kann es darauf reagieren und den Verbindungsaufbau einleiten. Alternativ kann das Endgerät aktiv Probe Request Frames aussenden, in denen es gezielt nach bestimmten SSIDs fragt. Empfängt ein Access Point eine solche Anfrage und will antworten, schickt er ein Probe Response Frame zurück. Verzichtet ein AP auf die Angabe der SSID in seinen Beacon- oder Probe-Frames, spricht man von einem Hidden Access Point.
 >
 >Nach der Kontaktaufnahme folgt die 802.11-Authentifikation8. Diese Authentifikation dient primär dem Nachweis, dass das Gerät überhaupt 802.11 sprechen kann und dass die empfangenen Signale nicht zufällige Artefakte sind. In einer folgenden Assoziationsphase werden die finalen Kommunikationsparameter ausgehandelt, dazu gehören tatsächlich verwendete Bitraten und die Sicherheitsparameter. Bis eine PSK- basierte oder eine 802.1X/EAP-Authentifikation samt Schlüsselvereinbarung erfolgt ist, lässt der AP in der Regel keinen anderen verschlüsselten Datenverkehr zu. Bei Beendigung der Sitzung, bei Störungen oder wenn das Endgerät die Funkzelle verlässt, kann es sich bei einem anderen AP im ESS reassoziieren (Roaming) oder vom AP deassoziiert bzw. deauthentifiziert werden.
 >
 >Da Funkübertragung nicht gerichtet ist, können unverschlüsselte Frames potenziell von jedem in Reichweite mitgelesen und ausgewertet werden. Das betrifft insbesondere viele Management-Frames, die in den oben beschriebenen Phasen verwendet werden. Entsprechend sind Manipulationen durch selbst erzeugte bzw. injizierte Frames möglich, zum Beispiel um Verbindungen zu stören oder Clients zum Verlassen eines AP zu bewegen. Hinweis: Moderne Standards bieten mit Protected Management Frames (PMF, IEEE 802.11w) Schutzmechanismen gegen bestimmte Arten von Manipulationen und Deauthentication-Angriffen. Auch wenn die Data Frames bei Einsatz von WPA2/WPA3 verschlüsselt übertragen werden, bleiben Metadaten wie MAC-Adressen und Radiotap-Informationen für Beobachter sichtbar. Nur wenn die Verschlüsselung kompromittiert wurde, ist ein Lesen der Nutzdaten möglich. Weitere Details dazu behandeln wir in einem späteren Praktikum.
 
 >[!example] Vorbereitung
 >In diesem Praktikum befassen Sie sich mit Funksignalen, die von Wi-Fi-Geräten ausgesendet werden. Mit entsprechender Vorbereitung können diese Signale aus der unmittelbaren Umgebung nicht nur empfangen, sondern auch analysiert oder – in Grenzen – beeinflusst werden. Im Fokus stehen dabei nicht die physikalischen Details der Signalübertragung, sondern die bereits interpretierten Datenstrukturen des Protokollstacks. Im IEEE 802.11 Standard werden diese Daten als Frames bezeichnet.
 >
 >Von besonderem Interesse für den Verbindungsaufbau sind die regelmäßig von **Access Points (AP) ausgesendeten Beacon Frames (kurz: Beacons)**. Sie signalisieren die Verfügbarkeit eines Netzwerks und enthalten grundlegende Informationen, wie etwa zur SSID oder unterstützten Datenraten. Der AP kündigt damit kontinuierlich seine Präsenz an alle Geräte im Empfangsbereich an. Endgeräte (Clients) müssen jedoch nicht ausschließlich auf eintreffende Beacons bekannter Netzwerke warten, sondern können auch aktiv suchen. Dazu senden sie **Probe Requests (kurz: Probes)**, in denen gezielt nach einer bestimmten SSID gefragt wird. Trifft ein solches Probe beim passenden AP ein, antwortet dieser mit einem **Probe Response** und signalisiert so seine Bereitschaft zur Kommunikation.
 >
 >Eine Übersicht der in diesem Zusammenhang häufig verwendeten Abkürzungen ist in** Tabelle 2** zusammengefasst.
 >
 >![[Pasted image 20251023195644.png]]
 >
 >Nach der Verbindung des USB-Adapters:
 >- kann mittels `nmcli dev wifi` eine liste der sich in der Nähe befindenden Funktnetze aufgerufen werden
 >- zum auflisten aller Drathlosennetzwerke: `sudo iw dev`
 >- zum Prüfen unterstützter Interface-Modi: `sudo iw list`
 >- Aktivieren des Monitoring Mode: `sudo airmon-ng start wlan0`
 >- zum Prüfen ob es Funktioniert hat: `ip a` -> `wlan0mon`
 >- lesen des Funktverkehrs: `sudo airodump-ng wlan0mon`
 >	- spalte wechseln: `s`
 >	- sortierreihnfolge ändern: `i`
 >	- Übersicht Endgeräte: `a`
 >![[Pasted image 20251024134250.png]]
 >

>[!example] Die Aircrack-Suite: Versteckte Drahtlosenetzwerke enttarnen
>1. In `arodump-ng` mit `s` in Spalte BSSID wechseln mit `tab` Auswahlmodus und BSSID des versteckten AP suchen
>
>2. Pausieren der Ausgabe mit `Leertaste` -> notieren der MAC-Adresse der BSSID und den Kanal
>
>3. Mit schneiden: `sudo airodump-ng -w capture -c Kanal wlanXmon` und seperates terminal: `dumpcap -i wlanXmon -w reference.pcapng`
>
>4. Makieren des Ziel-AP mittels Auswahlmodus `Tab` und einfärben mit `m` beenden mittels `Tab`
>
>5. Wechseln in den STA only Modus `a` und ermitteln der MAC-Adresse der STATION
>
>6. Die SSID (der Name) eines versteckten Netzwerks wird nur übertragen, wenn sich ein Client verbindet. Sie können passiv warten oder einen verbundenen Client aktiv zur erneuten Authentifizierung zwingen. Öffnen Sie ein neues Terminal und führen Sie, folgenden Befehl14 aus, um gezielte Deauthentication-Pakete zu senden: `sudo aireplay-ng --deauth 10 -a BSSID -c STATION wlanXmon` Der Befehl sendet Frames mit gefälschter MAC-Adresse vom AP an den Client, wodurch der Client zur Neuverbindung gezwungen wird. Beim Neuaufbau der Verbindung überträgt der Client die SSID, die Sie dadurch aufzeichnen können.
>
>7. Zurück in airodump-Fenster wechseln, wieder `a` für AP Übersicht Wenn der Client beim Verbindungsaufbau die SSID sendet, wird der Netzwerkname im markierten Eintrag sichtbar. Sie haben damit das versteckte Netzwerk erfolgreich enttarnt!
>
>8. Beenden `airodump-ng` und `dumpcap` 

>[!example] Netzwerkmitschnitte analysieren
>Im letzten Schritt sollen Sie die zuvor aufgezeichneten Daten noch weiter aufbereiten, visualisieren und interpretieren. Dabei wechseln wir bewusst zwischen unterschiedlichen Blickwinkeln: von der grafischen Darstellung von Beziehungen bis hin zur forensischen Detailanalyse im Paket.
>
>1. Visualisieren von Beziehungen zwischen APs und Clients:
>- `sudo airgraph-ng -i capture-01.csv -o capr.png -g CAPR && xdg-open capr.png`
>
>2. Analysieren von capture-01.cap `wireshark capture-01.cap`
>
>3. Zeigen Sie alle **Beacon-Frames** mit dem Filter: `wlan.fc.type_subtype == 0x08` Der Wert BI = xyz steht für das Beacon-Intervall (100 BI = 102.4 ms). Sie sehen hier pro AP nur ein einzelnes Beacon-Frame – airodump-ng filtert absichtlich, um die Datenmenge klein zu halten. Beachten Sie: Ein leeres SSID-Feld (Wildcard) in einem Beacon deutet auf ein verstecktes Netzwerk hin.
>![[Pasted image 20251024142527.png]]
>- Wenn nach einer bestimmten SSID gesucht werden soll:
>	- `wlan.ssid == "eduroam"` -> Exakte SSID
>	- `wlan.ssid ~ "edu"` -> Teilwort in SSIDs
>	- `_ws.col.info ~ "edu"` -> Teilwort in der Spalte "info"
>
>4. Filtern nach Probe Requests: `wlan.fc.type_subtype == 0x04`
> 	- Sie sehen damit alle Clients, die aktiv nach Netzwerken suchen. Leere SSIDs bedeuten Wildcard-Scans: das Gerät fragt nach „irgendeinem“ Netz in Reichweite. Daraufhin melden sich alle APs in Empfangsreichweite zurück.
> 	- Privacy Leak: Aktive Suchanfragen können identifizierende Merkmale preisgeben. Beson- ders problematisch sind sogenannte Directed Probes, bei denen ein Client gezielt nach einer bestimmten SSID sucht. Aus solchen Probes lassen sich Rückschlüsse auf frühere Verbindungen, eingesetzte Dienste oder sogar einzelne Geräteprofile ziehen. Achten Sie darauf, ob Sie gezielte SSID-Abfragen oder wiederkehrende SSID-Muster finden. Beachten Sie außerdem, dass viele Geräte MAC-Randomisierung nutzen, was eine stabile Zuordnung erschweren kann.
> 
> 5. Filtern nach Probe Responses: `wlan.fc.type_subtype == 0x05`
> 	- Probe Responses sind Antworten von Access Points auf aktive Anfragen. Praktischer Hinweis: Eine leere SSID in einer Probe Response ist unüblich und tritt in der Praxis nicht auf.
> 
> 6. Deauthentication-Angriff: 
> 	 - alle Filter entfernen
> 	 - `I/O-Graph` -> `wlan.addr[0:3] == 3C:71:BF`
> 	 - Bei Bedarf können Sie die Anzeige im unteren Dialogbereich auch auf eine logarithmische Skala umstellen, was bei der Übersichtlichkeit helfen kann. Nach mindestens einem der Berge sollte die Datenrate stark abfallen oder sogar kurz auf Null sinken. Wenn Sie die Bergspitze Linksklicken, springt Wireshark im Hintergrund zu diesem Paket und Sie sollten sich inmitten mehrerer Deauthentication-Pakete befinden (ggf. Dialog kurz verschieben)
> 
> 7. Ergänzen Sie einen zweiten Graphen mit dem Spaltennamen „Deauth“ und dem Filter `wlan.fc.type_subtype == 0x0c`. 
> 	- Sie dürfen auch gern die Farben der Graphen anpassen, um eine bessere Übersichtlichkeit zu gewährleisten. Ein plötzlicher Burst von Deauthentication-Paketen ist ein Indikator für einen Angriff.
>
>8. Öffnen Sie über das Menü `[ Wireless | WLAN Traffic ]` 
>	- die Zusammenfassung der WLAN-Aktivitäten. Dort sehen Sie APs, interagierende Clients, SSIDs, Kanäle sowie Summen von Beacons, Probes, Daten- und Deauth-Paketen. Versuchen Sie, die bisher gewonnenen Erkenntnisse mit diesen Daten abzugleichen.
>
>![[Pasted image 20251027144831.png]]


