
>[!info] 
>Über das gesamte Testsystem hinweg sind exemplarisch für „interessante Daten“ sogenannte Gems (Edelsteine) versteckt. In diesem Praktikum nehmen Sie die Perspektive eines Angreifers ein und bewerten das Testnetzwerk im Rahmen eines Red Team Assessments. Sie agieren dabei ohne zusätzliche Hintergrundinformationen und orientieren sich ausschließlich an den Hinweisen, die Sie während Ihrer Angriffe entdecken – ganz so, wie es ein realer Angreifer erleben würde. 
>
>Ziel ist es, alle Gems aufzuspüren und im Anschluss zu einer Datei zusammenzusetzen. Achten Sie dabei auf die korrekte Reihenfolge, da nur eine Variante zum vollständigen Ergebnis führt. Das System stellt Ihnen auf dem Weg verschiedene Hinweise bereit, sobald Sie einen validen Angriffspunkt gefunden haben. Diese Hinweise sollen Ihnen unnötig lange BruteForce-Phasen ersparen und die Analyse unterstützen.

>[!example]
>![[Pasted image 20251130144829.png]]

#### Host 192.168.1.2
![[Pasted image 20251130145022.png]]
>[!abstract] Finger Service Remote Information Disclosure Vulnerability (79/tcp)
>
>Summary: The finger service on the remote host is prone to an information disclosure vulnerability
>
>NVT: Finger Service Remote Information Disclosure Vulnerability
>OID: 1.3.6.1.4.1.25623.1.0.802236
>Threat: Medium (CVSS: 5.0)
>Port: 79/tcp
>References: CVE-1999-0612
>
>**Vulnerability Detection Result**: Vulnerability was detected according to the Vulnerability Detection Method.
>
>**Impact**: Successful exploitation will allow an attacker to obtain sensitive information that could aid in further attacks.
>
>**Solution**: Mitigation Disable the finger service, or install a finger service or daemon that limits the type of information provided.
>
>**Vulnerability Insight**: The flaw exists because the finger service exposes valid user information to any entity on the network. Remark: NIST don’t see ’configuration issues’ as software flaws so the referenced CVE has a severity of 0.0. The severity of this VT has been raised by Greenbone to still report a configuration issue on the target.

>[!success]
>
>```bash
>finger @192.168.1.2
>```
>- Login: root
>- name: root
>- TTy: tty7
>
>```bash
finger user@192.168.1.2
>```
>- login: hplip
>- Dir: /var/run/hplip
>- name: HPLIP user

>[!abstract] Sensitive File Disclosure (80/tcp)
>
>**Summary**: The script attempts to identify files containing sensitive data at the remote web server like e.g. software (Blog, CMS) configuration or log files, web / application server configuration / password files (.htaccess, .htpasswd, web.config, web.xml, ...), database backup files and SSH or SSL/TLS PrivateKeys.
>
>NVT: Sensitive File Disclosure (HTTP)
>OID: 1.3.6.1.4.1.25623.1.0.107305
>Threat: Medium (CVSS: 5.0)
>Port: 80/tcp
>
>Vulnerability Detection Result: The following files containing sensitive information were identified: Apache HTTP Server password file for Basic Authentication accessible.
>
>Match:
>- `sarah:$apr1$lttN3IFh$wXUhXlfVbeLB1B4koV.YU/`
>- `test:$apr1$pIJUlrh1$Ngwn2rd/m.zUi5LILTnIu1`
>
>Apache MD5-Hashing (APR1-MD)
>
>URL: http://192.168.1.2/.htusers
>
>**Impact**: Based on the information provided in these files an attacker might be able to gather additional info and/or sensitive data like usernames and passwords. 
>
>**Solution**: Mitigation
>The sensitive files shouldn’t be accessible via a web server. Restrict access to it or remove it completely.

>[!success] crack Hash
>```bash
>nano pass_md5.txt 
>	sarah:$apr1$lttN3IFh$wXUhXlfVbeLB1B4koV.YU/
>	test:$apr1$pIJUlrh1$Ngwn2rd/m.zUi5LILTnIu1
>```
>
>```bash
>john pass_md5.txt
>```
>
>![[Pasted image 20251130161804.png]]
>

>[!abstract] Cleartext Transmission of Sensitive Information via HTTP (8080/tcp)
>
>Summary: The host / application transmits sensitive information (username, passwords) in cleartext via HTTP.
>
>**NVT**: Cleartext Transmission of Sensitive Information via HTTP
>**OID**: 1.3.6.1.4.1.25623.1.0.108440
>**Threat**: Medium (CVSS: 4.8)
>**Port**: 8080/tcp
>**References:** OWASP 2013-A2
>OWASP 2013-A6
>CWE-319
>
>**Vulnerability Detection Result**: The following input fields where identified (URL:input name): http://192.168.1.2:8080/:password
>
>**Impact**: An attacker could use this situation to compromise or eavesdrop on the HTTP communication between the client and the server using a man-in-the-middle attack to get access to sensitive data like usernames or passwords.
>
>**Solution**: Workaround
>Enforce the transmission of sensitive data via an encrypted SSL/TLS connection. Additionally make sure the host / application is redirecting all users to the secured SSL/TLS connection before allowing to input sensitive data into the mentioned functions.
>
>**Vulnerability Detection Method**: Evaluate previous collected information and check if the host /application is not enforcing the transmission of sensitive data via an encrypted SSL/TLS connection. The script is currently checking HTTP Basic Authentication (Basic Auth) and HTTP Forms (e.g. Login) with input field of type ’password’.

#### Host 192.168.1.3
![[Pasted image 20251130172635.png]]
>[!abstract] FTP Unencrypted Claretext Login (21/tcp)
>Summary: The remote host is running a FTP service that allows cleartext logins over unencrypted connections.
>
>NVT: FTP Unencrypted Cleartext Login
>OID: 1.3.6.1.4.1.25623.1.0.108528
>Threat: Medium (CVSS: 4.8)
>Port: 21/tcp
>
>**Vulnerability Detection Result**: The remote FTP service accepts logins without a previous sent ’AUTH TLS’ command.
>
>**Response(s)**: Anonymous sessions: 331 Anonymous login ok, send your complete email address as your password Non-anonymous sessions: 331 Password required for gbnvt
>
>**Impact**: An attacker can uncover login names and passwords by sniffing traffic to the FTP service.
>
>**Solution**: Mitigation Enable FTPS or enforce the connection via the ’AUTH TLS’ command. Please see the manual of the FTP service for more information.

>[!abstract] Anonymous FTP Login Reporting (21/tcp)
>
>**Summary**: Reports if the remote FTP Server allows anonymous logins
>
>**NVT**: Anonymous FTP Login Reporting
>**OID**: 1.3.6.1.4.1.25623.1.0.900600
>**Threat**: Medium (CVSS: 6.4)
>**Port**: 21/tcp
>**References**: CVE-1999-0497
>
>**Vulnerability Detection Result**: It was possible to login to the remote FTP service with the following anonymous account: anonymous:anonymous
>
>Here are the contents of the remote FTP directory listing:
>```bash
-rw-r--r-- 1 ftp ftp 58 Jul 26 2018 finalExamHint.txt
-rw-r--r-- 1 ftp ftp 179 Jul 26 2018 gem.readme
-rw-r--r-- 1 ftp ftp 601838 Jul 26 2018 intercourse.jpg
>```
>
>**Impact**: Based on the files accessible via this anonymous FTP login and the permissions of this accountan attacker might be able to gain access to sensitive files and upload or delete files.
>
>**Solution**: Mitigation If you do not want to share files, you should disable anonymous logins.
>
>**Vulnerability Insight**: A host that provides an FTP service may additionally provide Anonymous FTP access as well. Under this arrangement, users do not strictly need an account on the host. Instead the user typically enters ’anonymous’ or ’ftp’ when prompted for username. Although users are commonly asked to send their email address as their password, little to no verification is actually performed on the supplied data. Remark: NIST don’t see ’configuration issues’ as software flaws so the referenced CVE has a severity of 0.0. The severity of this VT has been raised by Greenbone to still report a configuration issue on the target.

>[!abstract] Cleartext Transmission of Sensitive Information via HTTP (80/tcp)
>
>**Summary**: The host / application transmits sensitive information (username, passwords) in cleartext via HTTP.
>
>NVT: Cleartext Transmission of Sensitive Information via HTTP
>OID: 1.3.6.1.4.1.25623.1.0.108440
>Threat: Medium (CVSS: 4.8)
>Port: 80/tcp
>References 
>- OWASP 2013-A2
>- OWASP 2013-A6
>- CWE-319
>
>**Vulnerability Detection Result**: The following input fields where identified (URL:input name):
>http://192.168.1.3/:pass
>
>**Impact**: An attacker could use this situation to compromise or eavesdrop on the HTTP communication between the client and the server using a man-in-the-middle attack to get access to sensitive data like usernames or passwords.
>
>**Solution**: Workaround Enforce the transmission of sensitive data via an encrypted SSL/TLS connection. Additionally make sure the host / application is redirecting all users to the secured SSL/TLS connection before allowing to input sensitive data into the mentioned functions.
>
>**Vulnerability Detection Method**: Evaluate previous collected information and check if the host / application is not enforcing the transmission of sensitive data via an encrypted SSL/TLS connection. The script is currently checking HTTP Basic Authentication (Basic Auth) and HTTP Forms (e.g. Login) with input field of type ’password’.

