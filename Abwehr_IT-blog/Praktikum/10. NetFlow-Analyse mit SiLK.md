> [!info]
 SiLK als Tool für NetFlow Analysen. Flow beschreibt eine Folge von zusammenhängender und gerichteter Pakete, die eine unidirektionale Kommunikation zwischen zwei Endpunkten abbildet. Die Gruppierung erfolgt auf Basis gemeinsamer Attribute wie Quell- und Zieladresse, verwendete Ports und das transportierende Protokoll. Zusätzlich spielt die zeitliche Nähe der Pakete eine Rolle. Ein Flow kann beispielsweise automatisch enden, wenn für eine bestimmte Dauer keine weiteren Pakete beobachtet werden oder wenn ein neuer Flow mit abweichenden Parametern beginnt. Die genaue Definition eines Flows ist nicht vollständig standardisiert. Unterschiede zwischen gängigen Formaten wie NetFlow, IPFIX und den jeweiligen Tool Implementierungen sind üblich. Daher sollte man Flow-Begriffe stets im Kontext des eingesetzten Werkzeugs betrachten.
 >
 >Neben den eigentlichen Datenfeldern werden weitere Flow-Metadaten in Form von NetFlow Packet Headern erfasst. Diese Header enthalten allgemeine Informationen über die jeweilige NetFlow-Übertragung, etwa die verwendete Protokollversion oder die fortlaufende Flow-Sequenznummer. Sie sind wichtig, um die Konsistenz der Datenströme zu prüfen und die exportierten Flows korrekt einordnen zu können.
 >
 >![[Pasted image 20260111171626.png]]
 >

#### Beispiel: Client-Server Kommunikation 
>[!abstract]
>Client-Server-Kommunikation mit einem Webserver dargestellt und wie diese Interaktion durch verschiedene Flows modelliert werden kann.
>
>![[Pasted image 20260111171807.png]]
>

#### SiLK - Befehle
>[!info] Befehle
>
>![[Pasted image 20260111172243.png]]
### SilK lesen und interpretieren
>[!question]
>```bash
>rwfilter DATEI --protocol=6,17 --fail=stdout | rwuniq --fields=1,2,5,25
>```
>- Zeigt die Felder sip, dip, protocol, icmptypecode an die weder TCP (6) noch UDP (17) Verbindungen sind. (Überblick über alle nicht TCP/UDP Verbindungen)
>
>```bash
>rwset DATEI --sip-file=current.sipset
>```
>- Erzeugt eine Liste der Quell-IPs der DATEI
>
>```bash
>rwsettool --difference current.sipset whitelist.sipset > difference.sipset
>```
>- Ermittelt die Differenz zwischen allen Quell IPs und einer Whitelist erlaubter IPs. Das Ergebniss enthält nur unbekannt bzw. unerwartete IPs.
>
>```bash
>rwfilter DATEI --sipset=difference.sipset --pass=stdout | rwfilter --input-pipe=stdin --dport=53 --fail=stdout | 
>rwuniq  -fields=1,2,4
>```
>- Filtert aus den unbekannten IPs alle Verbindungen, die nicht zum DNS-Port (53) gehöhren, und fassen sie zusammen. Die Ausgabe zeigt Quell- und Ziel-IP sowie das verwendete Protokoll, wodurch auffällige Aktivitäten schnell identifiziert werden können.

>[!question] 
>Assoziieren Sie die IP-Adressen mit Clients bzw. Servern und interpretieren Sie, was hier passiert:
>
>![[Pasted image 20260112105122.png]]
>
>- 1. Anfrage von 192.168.1.42 an DNS Server über port 53 (DNS Auflösung)
>- 2. Antwort von DNS-Server (201.27.3.17)
>- 3. Verbindungsaufbau an FTP-Server Client (192.168.1.42) -> Server (177.52.80.112) über Port 21
>- 4. Antwort (FTP-Server) 
>
>![[Pasted image 20260112105642.png]]
>
>

### Planung: Sensoren und deren Platzierung im Netzwerk
>[!abstract] Sensortypen
>- **Netzwerksensoren:** erfassen den Netzwerkdatenverkehr direkt und werden an Netzwerkgeräte mit Routing-Funktionalität (z. B. Router, Switch, Hub) angebunden.
>>
>- **Hostsensoren:** hingegen sind mit Endpunkten (Server oder Clients) assoziiert und stützen sich primär auf Logdateien und Ereignisüberwachungen (z. B. Logins, Dateizugriffe, Kernelaktivitäten), lassen sich also als Form der Betriebssystemüberwachung interpretieren. Darüber hinaus kann auch der lokale Netzwerkdatenverkehr auf einem Host erfasst werden. Eine spezielle Variante des Hostsensors ist der **Servicesensor**, der sich gezielt auf einen einzelnen Dienst konzentriert (z. B. Webserver oder FTP-Server).

> [!question]
> Versuchen Sie, im dargestellten Netzwerk aus Abbildung 3 relevante Sensoren für die Netzwerküberwachung zu identifizieren.
> 
> ![[Pasted image 20260118124516.png]]
> 
>>[!success] Mögliche Host- und Servicesensoren
>>- Q-S Überwachung erforderlich: Server sollen mindestens mit Servicesensoren ausgestatet werden; bei besonders intensiver Überwachung auch einsatz von Hostsensoren möglich.
>>>
>>- T-X Überwachung optional: Workstations können bei bedarf mit Hostsensoren überwacht werden; aufgrund der hohen Datenmenge wird dies häufig nicht umgesetzt.
>
>>[!question] Übersicht Netzwerkaufbau Netzwerkgeräte
>>- B) Router verbindet das Internet (A) mit zwei Systemen (I,J) und einem Netzwerksegment (C)
>>- D) Switch stellt Verbindung zwischen zwei Systemen (S,T) sowie zwei Segmenten (C, E) her
>> - F) Switch stellt Verbindung zu Workstations (U-W) her sowie zu  Segmenten (E) und (G)
>> - H) Hub verteilt den Datenverkehr zwischen G und P (G=P_1-3) 
>
>>[!question] Filter Konfiguration
>> Router und Switch leiten Datenpakete als Unicast weiter, wobei der Router die Wegfindung über IP-Roiutingtabellen durchführt und der Switch die Weiterleitung anhand von MAC-Adressen steuert.
>> Ein Hub hingegen spiegelt den gesamten Datenverkehr als Broadcast an alle angeschlossenen Ports, ohne gezielte Weiterleitung.
>
>>[!question] Kanten der Netzwerkgeräte
>>Die Kanten C, E, G verbinden relevante Netzwerkgeräte und bieten sich als Filterpunkte an, um den Datenverkehr gezielt zu überwachen und Redunanzen zu vermeiden.
>>
>>[!question] Setzen von Sensoren
>>Die Überwachung des Hubs (H) kann durch die kante (G) erfolgen, da der Hub keinen selektiven Datenverkehr weiterleitet, ein eigener Sensor ist hier nicht notwendig. Die Überwachung der Kanten G, M, N und O erfasst die gesamte Kommunikation aller Workstations untereinander. Kante E überwacht die Kommunikation der Workstations mit dem restlichen Netzwerk. Die Überwachung von A ermöglicht die Kontrolle externer Zugriffe und Anfragen ans Netzwerk und kann helfen, potenzielle Angriffsversuche frühzeitig zu erkennen.
>
>>[!success]
>>Top-Down-Verfahren:
>>- B
>>- D (nichts über C/B)
>>- F (nichts über E/D)
>>
>>![[Pasted image 20260118153412.png]]




